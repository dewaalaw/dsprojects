---
title: "Part 3 - Confirmatory Factor Analysis"
output: github_document
editor_options: 
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r coding.environment, echo=FALSE}
lapply(c('lubridate', 'psych', 'tidyverse'), library, character.only=TRUE)
data = read_csv('~/Documents/Exercises/human-values-scale/data/data.csv')
```

# Factor Analysis—Confirmatory Factor Analysis

The model below postulates that the four underlying latent variables (self-transcendence, conservation, change, and self-enhancement) are generated by the observed variables (or indicators). Further, no correlation is assumed between the latent variables. Estimated by the model are the structural coefficients ($\lambda$), measuring the association between the latent variable and its indicators, and variances ($\mu$)—noting that the *"importance to think new ideas and being creative"* (ipcrtiv) has loaded below the 0.3 threshold and thus dropped.

```{r confirmatory.factor.analysis}
#install.packages("lavaan")
library(lavaan)

confirm.fact <- ' f1.self.enhance =~ imprich + ipshabt + ipsuces + iprspot
f2.self.trancend =~ ipeqopt + ipudrst + iphlppl +ipmodst + impfree + 
                    iplylfr + impenv
f3.conservation =~ impsafe + ipfrule + ipbhprp + ipstrgv + imptrad
f4.change =~ impdiff + ipgdtim + ipadvnt + impfun
'
fit.lavaan <- cfa(confirm.fact, data = data, orthogonal=TRUE)

inspect(fit.lavaan, what="std")$lambda
```

```{r}
semPaths(fit.lavaan, title = FALSE, curvePivot = TRUE, what="std")
summary(fit.lavaan)
```

```{r}
fitMeasures(fit.lavaan, c("chisq", "gfi", "agfi", "gfi", "nfi", "nnfi", "cfi", "pgfi", "pnfi", "srmr", "RMSEA"),
+             output = "matrix")
```

The standardised root mean square residual (SRMR), root means square error of approximation (RMSEA), (adjusted) goodness of fit index ((A)GFI), suggest inadequate model fit (for model fit thresholds, see Belhekar, 2019, p. 45).
